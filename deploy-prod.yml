- name: Deploy Insurance App to Prod
  hosts: prod
  become: yes
  tasks:
    - name: Stop running container if exists
      shell: docker stop insurance-app-prod || true
      ignore_errors: yes

    - name: Remove existing container if exists
      shell: docker rm insurance-app-prod || true
      ignore_errors: yes

    - name: Pull latest Docker image
      shell: docker pull bromaaascripts/insurance-app:latest

    - name: Run container
      shell: docker run -d -p 8081:8082 --name insurance-app-prod bromaaascripts/insurance-app:latest
